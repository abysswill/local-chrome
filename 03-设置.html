<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è®¾ç½® - æ¡Œé¢ç®¡ç†ç¨‹åº</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg-color: #F8FAFC;
      --card-bg: #FFFFFF;
      --text-primary: #1E293B;
      --text-secondary: #64748B;
      --border-color: #E2E8F0;
      --primary-color: #2563EB;
      --primary-hover: #1D4ED8;
      --success-color: #16A34A;
      --warning-color: #F97316;
      --error-color: #DC2626;
      --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
      --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
      --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: var(--bg-color);
      min-height: 100vh;
      color: var(--text-primary);
    }

    /* é¡¶éƒ¨å¯¼èˆªæ  */
    .navbar {
      background: var(--card-bg);
      border-bottom: 1px solid var(--border-color);
      padding: 0 24px;
      height: 64px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: var(--shadow-sm);
    }

    .navbar-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .back-button {
      width: 32px;
      height: 32px;
      border: none;
      background: var(--bg-color);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s;
      color: var(--text-primary);
    }

    .back-button:hover {
      background: var(--primary-color);
      color: white;
    }

    .page-title {
      font-size: 20px;
      font-weight: 600;
    }

    /* è®¾ç½®å®¹å™¨ */
    .settings-container {
      display: flex;
      height: calc(100vh - 64px);
    }

    /* ä¾§è¾¹æ  */
    .sidebar {
      width: 280px;
      background: var(--card-bg);
      border-right: 1px solid var(--border-color);
      padding: 24px 0;
      overflow-y: auto;
    }

    .sidebar-item {
      padding: 12px 24px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 12px;
      color: var(--text-secondary);
      text-decoration: none;
      border-left: 3px solid transparent;
    }

    .sidebar-item:hover {
      background: var(--bg-color);
      color: var(--text-primary);
    }

    .sidebar-item.active {
      background: rgba(37, 99, 235, 0.1);
      color: var(--primary-color);
      border-left-color: var(--primary-color);
    }

    .sidebar-icon {
      font-size: 18px;
    }

    /* ä¸»å†…å®¹åŒºåŸŸ */
    .settings-content {
      flex: 1;
      padding: 32px;
      overflow-y: auto;
    }

    .settings-section {
      display: none;
    }

    .settings-section.active {
      display: block;
      animation: fadeIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .section-header {
      margin-bottom: 32px;
    }

    .section-title {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .section-description {
      color: var(--text-secondary);
      font-size: 14px;
    }

    .settings-group {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 24px;
      border: 1px solid var(--border-color);
    }

    .settings-group-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 20px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--border-color);
    }

    .setting-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 0;
      border-bottom: 1px solid var(--border-color);
    }

    .setting-item:last-child {
      border-bottom: none;
    }

    .setting-left {
      flex: 1;
    }

    .setting-label {
      font-weight: 500;
      margin-bottom: 4px;
    }

    .setting-description {
      font-size: 12px;
      color: var(--text-secondary);
    }

    .setting-control {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    /* è¡¨å•æ§ä»¶ */
    .form-input {
      padding: 8px 12px;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      font-size: 14px;
      background: var(--bg-color);
      transition: all 0.2s;
      width: 200px;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .form-input.wide {
      width: 100%;
    }

    .form-select {
      padding: 8px 12px;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      font-size: 14px;
      background: var(--bg-color);
      cursor: pointer;
      transition: all 0.2s;
      width: 200px;
    }

    .form-select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .switch {
      position: relative;
      width: 44px;
      height: 24px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--border-color);
      transition: 0.3s;
      border-radius: 24px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background: white;
      transition: 0.3s;
      border-radius: 50%;
    }

    input:checked + .slider {
      background: var(--primary-color);
    }

    input:checked + .slider:before {
      transform: translateX(20px);
    }

    .button {
      padding: 8px 16px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s;
      font-weight: 500;
    }

    .button-primary {
      background: var(--primary-color);
      color: white;
    }

    .button-primary:hover {
      background: var(--primary-hover);
    }

    .button-secondary {
      background: var(--bg-color);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
    }

    .button-secondary:hover {
      background: var(--border-color);
    }

    .button-danger {
      background: var(--error-color);
      color: white;
    }

    .button-danger:hover {
      background: #B91C1C;
    }

    /* æ“ä½œæŒ‰é’®åŒºåŸŸ */
    .action-buttons {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 24px;
      border: 1px solid var(--border-color);
      display: flex;
      justify-content: flex-end;
      gap: 12px;
    }

    .button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Toast é€šçŸ¥ */
    .toast {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 16px 20px;
      box-shadow: var(--shadow-lg);
      display: flex;
      align-items: center;
      gap: 12px;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.3s;
      z-index: 1000;
      max-width: 320px;
    }

    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }

    .toast-icon {
      font-size: 20px;
    }

    .toast.success {
      border-left: 4px solid var(--success-color);
    }

    .toast.error {
      border-left: 4px solid var(--error-color);
    }

    .toast.warning {
      border-left: 4px solid var(--warning-color);
    }

    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 768px) {
      .settings-container {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        display: flex;
        overflow-x: auto;
        padding: 16px 0;
        border-right: none;
        border-bottom: 1px solid var(--border-color);
      }

      .sidebar-item {
        white-space: nowrap;
        padding: 12px 16px;
        border-left: none;
        border-bottom: 3px solid transparent;
      }

      .sidebar-item.active {
        border-left: none;
        border-bottom-color: var(--primary-color);
      }

      .settings-content {
        padding: 24px 16px;
      }

      .form-input,
      .form-select {
        width: 100%;
      }

      .setting-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
      }

      .action-buttons {
        flex-direction: column;
      }
    }

    /* æš—é»‘ä¸»é¢˜ */
    @media (prefers-color-scheme: dark) {
      :root {
        --bg-color: #0F172A;
        --card-bg: #1E293B;
        --text-primary: #F1F5F9;
        --text-secondary: #94A3B8;
        --border-color: #334155;
      }
    }

    body.dark-theme {
      --bg-color: #0F172A;
      --card-bg: #1E293B;
      --text-primary: #F1F5F9;
      --text-secondary: #94A3B8;
      --border-color: #334155;
    }
  </style>
</head>
<body>
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <nav class="navbar">
    <div class="navbar-left">
      <button class="back-button" onclick="history.back()">â†</button>
      <h1 class="page-title">è®¾ç½®</h1>
    </div>
  </nav>

  <div class="settings-container">
    <!-- ä¾§è¾¹æ  -->
    <aside class="sidebar">
      <a href="#" class="sidebar-item active" data-section="user">
        <span class="sidebar-icon">ğŸ‘¤</span>
        <span>ç”¨æˆ·è®¾ç½®</span>
      </a>
      <a href="#" class="sidebar-item" data-section="system">
        <span class="sidebar-icon">âš™ï¸</span>
        <span>ç³»ç»Ÿè®¾ç½®</span>
      </a>
      <a href="#" class="sidebar-item" data-section="appearance">
        <span class="sidebar-icon">ğŸ¨</span>
        <span>å¤–è§‚è®¾ç½®</span>
      </a>
    </aside>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <main class="settings-content">
      <!-- ç”¨æˆ·è®¾ç½® -->
      <section class="settings-section active" id="user-settings">
        <div class="section-header">
          <h2 class="section-title">ç”¨æˆ·è®¾ç½®</h2>
          <p class="section-description">ç®¡ç†æ‚¨çš„ä¸ªäººè´¦æˆ·ä¿¡æ¯å’Œç™»å½•åå¥½</p>
        </div>

        <div class="settings-group">
          <h3 class="settings-group-title">ä¸ªäººä¿¡æ¯</h3>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">ç”¨æˆ·å</div>
              <div class="setting-description">æ‚¨çš„ç™»å½•ç”¨æˆ·å</div>
            </div>
            <div class="setting-control">
              <input type="text" class="form-input" id="username" value="admin">
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">æ˜¾ç¤ºåç§°</div>
              <div class="setting-description">åœ¨ç•Œé¢ä¸­æ˜¾ç¤ºçš„åç§°</div>
            </div>
            <div class="setting-control">
              <input type="text" class="form-input" id="displayName" value="ç®¡ç†å‘˜">
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">é‚®ç®±åœ°å€</div>
              <div class="setting-description">ç”¨äºæ¥æ”¶ç³»ç»Ÿé€šçŸ¥</div>
            </div>
            <div class="setting-control">
              <input type="email" class="form-input" id="email" value="admin@example.com">
            </div>
          </div>
        </div>

        <div class="settings-group">
          <h3 class="settings-group-title">å®‰å…¨è®¾ç½®</h3>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">ä¿®æ”¹å¯†ç </div>
              <div class="setting-description">å®šæœŸæ›´æ”¹å¯†ç ä»¥ä¿æŠ¤è´¦æˆ·å®‰å…¨</div>
            </div>
            <div class="setting-control">
              <button class="button button-secondary" onclick="changePassword()">ä¿®æ”¹å¯†ç </button>
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">è‡ªåŠ¨ç™»å½•</div>
              <div class="setting-description">è·³è¿‡ç™»å½•é¡µé¢ç›´æ¥è¿›å…¥ç³»ç»Ÿ</div>
            </div>
            <div class="setting-control">
              <label class="switch">
                <input type="checkbox" id="autoLogin">
                <span class="slider"></span>
              </label>
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">è®°ä½å¯†ç </div>
              <div class="setting-description">åœ¨æœ¬åœ°ä¿å­˜ç™»å½•ä¿¡æ¯</div>
            </div>
            <div class="setting-control">
              <label class="switch">
                <input type="checkbox" id="rememberPassword" checked>
                <span class="slider"></span>
              </label>
            </div>
          </div>
        </div>
      </section>

      <!-- ç³»ç»Ÿè®¾ç½® -->
      <section class="settings-section" id="system-settings">
        <div class="section-header">
          <h2 class="section-title">ç³»ç»Ÿè®¾ç½®</h2>
          <p class="section-description">é…ç½®ç³»ç»ŸåŠŸèƒ½å’Œç½‘é¡µåœ°å€</p>
        </div>

        <div class="settings-group">
          <h3 class="settings-group-title">åŠŸèƒ½ç½‘å€é…ç½®</h3>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">ç”¨æˆ·ç®¡ç†ç½‘å€</div>
              <div class="setting-description">ç”¨æˆ·ç®¡ç†æ¨¡å—çš„è®¿é—®åœ°å€</div>
            </div>
            <div class="setting-control">
              <input type="url" class="form-input wide" id="userManagementUrl"
                     placeholder="https://example.com/users" value="https://example.com/users">
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">æ•°æ®åˆ†æç½‘å€</div>
              <div class="setting-description">æ•°æ®åˆ†ææ¨¡å—çš„è®¿é—®åœ°å€</div>
            </div>
            <div class="setting-control">
              <input type="url" class="form-input wide" id="analyticsUrl"
                     placeholder="https://example.com/analytics" value="https://example.com/analytics">
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">ç³»ç»Ÿç›‘æ§ç½‘å€</div>
              <div class="setting-description">ç³»ç»Ÿç›‘æ§æ¨¡å—çš„è®¿é—®åœ°å€</div>
            </div>
            <div class="setting-control">
              <input type="url" class="form-input wide" id="monitorUrl"
                     placeholder="https://example.com/monitor" value="https://example.com/monitor">
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">æ¶ˆæ¯ä¸­å¿ƒç½‘å€</div>
              <div class="setting-description">æ¶ˆæ¯ä¸­å¿ƒæ¨¡å—çš„è®¿é—®åœ°å€</div>
            </div>
            <div class="setting-control">
              <input type="url" class="form-input wide" id="messagesUrl"
                     placeholder="https://example.com/messages" value="https://example.com/messages">
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">å¸®åŠ©æ–‡æ¡£ç½‘å€</div>
              <div class="setting-description">å¸®åŠ©æ–‡æ¡£çš„è®¿é—®åœ°å€</div>
            </div>
            <div class="setting-control">
              <input type="url" class="form-input wide" id="helpUrl"
                     placeholder="https://example.com/help" value="https://example.com/help">
            </div>
          </div>
        </div>

        <div class="settings-group">
          <h3 class="settings-group-title">ç³»ç»Ÿè¡Œä¸º</h3>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">é»˜è®¤æµè§ˆå™¨</div>
              <div class="setting-description">æ‰“å¼€å¤–éƒ¨ç½‘é¡µæ—¶ä½¿ç”¨çš„æµè§ˆå™¨</div>
            </div>
            <div class="setting-control">
              <select class="form-select" id="defaultBrowser">
                <option value="system">ç³»ç»Ÿé»˜è®¤</option>
                <option value="chrome">Google Chrome</option>
                <option value="firefox">Mozilla Firefox</option>
                <option value="edge">Microsoft Edge</option>
                <option value="safari">Safari</option>
              </select>
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">å¼€æœºè‡ªå¯åŠ¨</div>
              <div class="setting-description">ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œæœ¬ç¨‹åº</div>
            </div>
            <div class="setting-control">
              <label class="switch">
                <input type="checkbox" id="autoStart">
                <span class="slider"></span>
              </label>
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">æ•°æ®åŒæ­¥</div>
              <div class="setting-description">è‡ªåŠ¨åŒæ­¥è®¾ç½®å’Œæ•°æ®åˆ°äº‘ç«¯</div>
            </div>
            <div class="setting-control">
              <label class="switch">
                <input type="checkbox" id="dataSync">
                <span class="slider"></span>
              </label>
            </div>
          </div>
        </div>
      </section>

      <!-- å¤–è§‚è®¾ç½® -->
      <section class="settings-section" id="appearance-settings">
        <div class="section-header">
          <h2 class="section-title">å¤–è§‚è®¾ç½®</h2>
          <p class="section-description">è‡ªå®šä¹‰ç•Œé¢ä¸»é¢˜å’Œè§†è§‰æ•ˆæœ</p>
        </div>

        <div class="settings-group">
          <h3 class="settings-group-title">ä¸»é¢˜è®¾ç½®</h3>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">ä¸»é¢˜æ¨¡å¼</div>
              <div class="setting-description">é€‰æ‹©æ‚¨å–œæ¬¢çš„ç•Œé¢ä¸»é¢˜</div>
            </div>
            <div class="setting-control">
              <select class="form-select" id="themeMode">
                <option value="light">æ˜äº®ä¸»é¢˜</option>
                <option value="dark">æš—é»‘ä¸»é¢˜</option>
                <option value="system">è·Ÿéšç³»ç»Ÿ</option>
              </select>
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">ä¸»é¢˜å¿«æ·é”®</div>
              <div class="setting-description">å¿«é€Ÿåˆ‡æ¢ä¸»é¢˜çš„å¿«æ·é”®</div>
            </div>
            <div class="setting-control">
              <input type="text" class="form-input" id="themeShortcut" value="Ctrl+Shift+T" readonly>
              <button class="button button-secondary" onclick="editShortcut()">ç¼–è¾‘</button>
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">åŠ¨ç”»æ•ˆæœ</div>
              <div class="setting-description">å¯ç”¨ç•Œé¢åŠ¨ç”»å’Œè¿‡æ¸¡æ•ˆæœ</div>
            </div>
            <div class="setting-control">
              <label class="switch">
                <input type="checkbox" id="enableAnimations" checked>
                <span class="slider"></span>
              </label>
            </div>
          </div>
        </div>

        <div class="settings-group">
          <h3 class="settings-group-title">æ˜¾ç¤ºè®¾ç½®</h3>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">å­—ä½“å¤§å°</div>
              <div class="setting-description">è°ƒæ•´ç•Œé¢æ–‡å­—å¤§å°</div>
            </div>
            <div class="setting-control">
              <select class="form-select" id="fontSize">
                <option value="small">å°</option>
                <option value="medium" selected>ä¸­</option>
                <option value="large">å¤§</option>
                <option value="xlarge">ç‰¹å¤§</option>
              </select>
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">ç¼©æ”¾æ¯”ä¾‹</div>
              <div class="setting-description">ç•Œé¢æ•´ä½“ç¼©æ”¾æ¯”ä¾‹</div>
            </div>
            <div class="setting-control">
              <select class="form-select" id="zoomLevel">
                <option value="80">80%</option>
                <option value="90">90%</option>
                <option value="100" selected>100%</option>
                <option value="110">110%</option>
                <option value="125">125%</option>
                <option value="150">150%</option>
              </select>
            </div>
          </div>
        </div>

        <div class="settings-group">
          <h3 class="settings-group-title">æ•°æ®ç®¡ç†</h3>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">å¯¼å…¥è®¾ç½®</div>
              <div class="setting-description">ä»æ–‡ä»¶å¯¼å…¥é…ç½®è®¾ç½®</div>
            </div>
            <div class="setting-control">
              <button class="button button-secondary" onclick="importSettings()">å¯¼å…¥</button>
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">å¯¼å‡ºè®¾ç½®</div>
              <div class="setting-description">å°†å½“å‰è®¾ç½®å¯¼å‡ºåˆ°æ–‡ä»¶</div>
            </div>
            <div class="setting-control">
              <button class="button button-secondary" onclick="exportSettings()">å¯¼å‡º</button>
            </div>
          </div>
          <div class="setting-item">
            <div class="setting-left">
              <div class="setting-label">é‡ç½®è®¾ç½®</div>
              <div class="setting-description">æ¢å¤æ‰€æœ‰è®¾ç½®ä¸ºé»˜è®¤å€¼</div>
            </div>
            <div class="setting-control">
              <button class="button button-danger" onclick="resetSettings()">é‡ç½®</button>
            </div>
          </div>
        </div>
      </section>

      <!-- æ“ä½œæŒ‰é’® -->
      <div class="action-buttons">
        <button class="button button-secondary" onclick="loadSettings()">é‡ç½®æ›´æ”¹</button>
        <button class="button button-primary" id="saveButton" onclick="saveSettings()">ä¿å­˜è®¾ç½®</button>
      </div>
    </main>
  </div>

  <!-- Toast é€šçŸ¥ -->
  <div class="toast" id="toast">
    <span class="toast-icon" id="toastIcon"></span>
    <span class="toast-message" id="toastMessage"></span>
  </div>

  <script>
    // ä¾§è¾¹æ åˆ‡æ¢
    const sidebarItems = document.querySelectorAll('.sidebar-item');
    const settingsSections = document.querySelectorAll('.settings-section');

    sidebarItems.forEach(item => {
      item.addEventListener('click', function(e) {
        e.preventDefault();

        // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
        sidebarItems.forEach(i => i.classList.remove('active'));
        settingsSections.forEach(s => s.classList.remove('active'));

        // æ·»åŠ å½“å‰æ´»åŠ¨çŠ¶æ€
        this.classList.add('active');
        const sectionId = this.dataset.section + '-settings';
        document.getElementById(sectionId).classList.add('active');
      });
    });

    // è®¾ç½®ç›¸å…³å˜é‡
    let hasChanges = false;
    let originalSettings = {};

    // æ£€æµ‹è¡¨å•å˜åŒ–
    const inputs = document.querySelectorAll('input, select');
    inputs.forEach(input => {
      input.addEventListener('change', function() {
        hasChanges = true;
        updateSaveButton();
      });
    });

    // æ›´æ–°ä¿å­˜æŒ‰é’®çŠ¶æ€
    function updateSaveButton() {
      const saveButton = document.getElementById('saveButton');
      saveButton.disabled = !hasChanges;
    }

    // æ˜¾ç¤º Toast é€šçŸ¥
    function showToast(message, type = 'success') {
      const toast = document.getElementById('toast');
      const toastIcon = document.getElementById('toastIcon');
      const toastMessage = document.getElementById('toastMessage');

      toast.className = `toast ${type}`;
      toastMessage.textContent = message;

      switch(type) {
        case 'success':
          toastIcon.textContent = 'âœ…';
          break;
        case 'error':
          toastIcon.textContent = 'âŒ';
          break;
        case 'warning':
          toastIcon.textContent = 'âš ï¸';
          break;
      }

      toast.classList.add('show');

      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

    // ä¿å­˜è®¾ç½®
    function saveSettings() {
      const settings = {
        // ç”¨æˆ·è®¾ç½®
        username: document.getElementById('username').value,
        displayName: document.getElementById('displayName').value,
        email: document.getElementById('email').value,
        autoLogin: document.getElementById('autoLogin').checked,
        rememberPassword: document.getElementById('rememberPassword').checked,

        // ç³»ç»Ÿè®¾ç½®
        userManagementUrl: document.getElementById('userManagementUrl').value,
        analyticsUrl: document.getElementById('analyticsUrl').value,
        monitorUrl: document.getElementById('monitorUrl').value,
        messagesUrl: document.getElementById('messagesUrl').value,
        helpUrl: document.getElementById('helpUrl').value,
        defaultBrowser: document.getElementById('defaultBrowser').value,
        autoStart: document.getElementById('autoStart').checked,
        dataSync: document.getElementById('dataSync').checked,

        // å¤–è§‚è®¾ç½®
        themeMode: document.getElementById('themeMode').value,
        themeShortcut: document.getElementById('themeShortcut').value,
        enableAnimations: document.getElementById('enableAnimations').checked,
        fontSize: document.getElementById('fontSize').value,
        zoomLevel: document.getElementById('zoomLevel').value
      };

      // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
      localStorage.setItem('appSettings', JSON.stringify(settings));

      // åº”ç”¨ä¸»é¢˜è®¾ç½®
      applyThemeSettings(settings.themeMode);

      hasChanges = false;
      updateSaveButton();
      showToast('è®¾ç½®ä¿å­˜æˆåŠŸï¼', 'success');
    }

    // åŠ è½½è®¾ç½®
    function loadSettings() {
      const savedSettings = localStorage.getItem('appSettings');

      if (savedSettings) {
        const settings = JSON.parse(savedSettings);
        originalSettings = {...settings};

        // å¡«å……è¡¨å•
        document.getElementById('username').value = settings.username || 'admin';
        document.getElementById('displayName').value = settings.displayName || 'ç®¡ç†å‘˜';
        document.getElementById('email').value = settings.email || 'admin@example.com';
        document.getElementById('autoLogin').checked = settings.autoLogin || false;
        document.getElementById('rememberPassword').checked = settings.rememberPassword !== false;

        document.getElementById('userManagementUrl').value = settings.userManagementUrl || 'https://example.com/users';
        document.getElementById('analyticsUrl').value = settings.analyticsUrl || 'https://example.com/analytics';
        document.getElementById('monitorUrl').value = settings.monitorUrl || 'https://example.com/monitor';
        document.getElementById('messagesUrl').value = settings.messagesUrl || 'https://example.com/messages';
        document.getElementById('helpUrl').value = settings.helpUrl || 'https://example.com/help';
        document.getElementById('defaultBrowser').value = settings.defaultBrowser || 'system';
        document.getElementById('autoStart').checked = settings.autoStart || false;
        document.getElementById('dataSync').checked = settings.dataSync || false;

        document.getElementById('themeMode').value = settings.themeMode || 'light';
        document.getElementById('themeShortcut').value = settings.themeShortcut || 'Ctrl+Shift+T';
        document.getElementById('enableAnimations').checked = settings.enableAnimations !== false;
        document.getElementById('fontSize').value = settings.fontSize || 'medium';
        document.getElementById('zoomLevel').value = settings.zoomLevel || '100';

        // åº”ç”¨ä¸»é¢˜
        applyThemeSettings(settings.themeMode);

        showToast('è®¾ç½®åŠ è½½å®Œæˆ', 'success');
      }

      hasChanges = false;
      updateSaveButton();
    }

    // åº”ç”¨ä¸»é¢˜è®¾ç½®
    function applyThemeSettings(themeMode) {
      const body = document.body;

      if (themeMode === 'dark') {
        body.classList.add('dark-theme');
      } else if (themeMode === 'light') {
        body.classList.remove('dark-theme');
      } else if (themeMode === 'system') {
        // è·Ÿéšç³»ç»Ÿä¸»é¢˜
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
          body.classList.add('dark-theme');
        } else {
          body.classList.remove('dark-theme');
        }
      }
    }

    // é‡ç½®è®¾ç½®
    function resetSettings() {
      if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰è®¾ç½®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚')) {
        localStorage.removeItem('appSettings');
        localStorage.removeItem('theme');

        // é‡ç½®è¡¨å•åˆ°é»˜è®¤å€¼
        document.getElementById('username').value = 'admin';
        document.getElementById('displayName').value = 'ç®¡ç†å‘˜';
        document.getElementById('email').value = 'admin@example.com';
        document.getElementById('autoLogin').checked = false;
        document.getElementById('rememberPassword').checked = true;

        document.getElementById('userManagementUrl').value = 'https://example.com/users';
        document.getElementById('analyticsUrl').value = 'https://example.com/analytics';
        document.getElementById('monitorUrl').value = 'https://example.com/monitor';
        document.getElementById('messagesUrl').value = 'https://example.com/messages';
        document.getElementById('helpUrl').value = 'https://example.com/help';
        document.getElementById('defaultBrowser').value = 'system';
        document.getElementById('autoStart').checked = false;
        document.getElementById('dataSync').checked = false;

        document.getElementById('themeMode').value = 'light';
        document.getElementById('themeShortcut').value = 'Ctrl+Shift+T';
        document.getElementById('enableAnimations').checked = true;
        document.getElementById('fontSize').value = 'medium';
        document.getElementById('zoomLevel').value = '100';

        applyThemeSettings('light');
        showToast('è®¾ç½®å·²é‡ç½®ä¸ºé»˜è®¤å€¼', 'success');
      }
    }

    // å¯¼å…¥è®¾ç½®
    function importSettings() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.json';

      input.onchange = function(e) {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(event) {
            try {
              const settings = JSON.parse(event.target.result);
              localStorage.setItem('appSettings', JSON.stringify(settings));
              loadSettings();
              showToast('è®¾ç½®å¯¼å…¥æˆåŠŸ', 'success');
            } catch (error) {
              showToast('è®¾ç½®å¯¼å…¥å¤±è´¥ï¼šæ–‡ä»¶æ ¼å¼é”™è¯¯', 'error');
            }
          };
          reader.readAsText(file);
        }
      };

      input.click();
    }

    // å¯¼å‡ºè®¾ç½®
    function exportSettings() {
      const settings = localStorage.getItem('appSettings');
      if (settings) {
        const blob = new Blob([settings], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `settings-${new Date().toISOString().slice(0, 10)}.json`;
        a.click();
        URL.revokeObjectURL(url);
        showToast('è®¾ç½®å¯¼å‡ºæˆåŠŸ', 'success');
      } else {
        showToast('æ²¡æœ‰å¯å¯¼å‡ºçš„è®¾ç½®', 'warning');
      }
    }

    // ä¿®æ”¹å¯†ç 
    function changePassword() {
      showToast('å¯†ç ä¿®æ”¹åŠŸèƒ½å°†åœ¨æ–°çª—å£ä¸­æ‰“å¼€', 'success');
      // è¿™é‡Œå¯ä»¥æ‰“å¼€å¯†ç ä¿®æ”¹çª—å£æˆ–è·³è½¬åˆ°å¯†ç ä¿®æ”¹é¡µé¢
    }

    // ç¼–è¾‘å¿«æ·é”®
    function editShortcut() {
      showToast('å¿«æ·é”®ç¼–è¾‘åŠŸèƒ½å¼€å‘ä¸­', 'warning');
    }

    // é¡µé¢åŠ è½½æ—¶åŠ è½½è®¾ç½®
    window.addEventListener('load', function() {
      loadSettings();
    });

    // é¡µé¢å…³é—­å‰æç¤ºä¿å­˜
    window.addEventListener('beforeunload', function(e) {
      if (hasChanges) {
        e.preventDefault();
        e.returnValue = '';
      }
    });
  </script>
</body>
</html>